

## 前置：服务器相关的知识

### 购买云服务器之后

1. 我们可以这个云端服务器看成一个我们远程的Linux电脑。

2. 如果购买的的是阿里云的云服务器，我们需要在安全组里面创建==安全组==（Linux防火墙的端口开完之后，一定还需要在阿里云上设置安全组规则），用来开启端口，否则外部无法访问。

   授权对象：`0.0.0.0/0`所有人可以访问

3. 获取服务器的==公网ip==地址；修改实例名称和密码，第一次修改需要重启！

4. Window: 我们可以用==xshell==远程连接服务器（远程连接，云服务只需要开22端口就可以了），用==xftp==来传输文件

5. Mac: 我们可以用==终端==连接远程服务器。

   ```
   1.ssh root@公网ip地址
   2.输入服务器密码，回车就可以连接服务器
   ```

6. 修改主机名hostname需要重启服务器,才会更新。

7. 连接服务器之后我们需要搭建环境（建议使用命令式的方式搭建环境，也可使用宝塔搭建环境）

6. 如果网站访问失败，一定是防火墙的原因（Linux服务器，阿里云安全组面板！）

   ```
   # 查看firewall服务状态
   systemctl status firewalld
   
   # 开启、重启、关闭、firewalld.service服务
   # 开启
   service firewalld start
   # 重启
   service firewalld restart
   # 关闭
   service firewalld stop
   
   # 查看防火墙规则
   firewall-cmd --list-all    # 查看全部信息
   firewall-cmd --list-ports  # 只看端口信息
   
   # 开启端口
   开端口命令：firewall-cmd --zone=public --add-port=80/tcp --permanent
   命令含义：
   --zone #作用域
   --add-port=80/tcp  #添加端口，格式为：端口/通讯协议
   --permanent   #永久生效，没有此参数重启后失效
   
   重启防火墙：systemctl restart firewalld.service
   ```

## 走进Linux系统

### 开机

开机会启动许多进程。它们在`windows`服务中叫做“服务”(`service`)，在Linux系统中叫做“守护进程”(`daemon`)

一般来说，用户的登录方式有三种：命令行登录，`ssh`登录，图形界面登录

最高权限账户为`root`，可以操作一切！

### 关机

在`linux`领域内大多数用在服务器上，很少遇到关机的操作。

毕竟服务器上跑一个服务是永无止境的，除非特殊情况下，不得已才会关机。

关机指令：`shutdown`

不管是重启系统还是关闭系统，首先要运行sync命令，把内存中的数据写到磁盘中。

### 重启

重启指令：`reboot`

这个命令通常需要`root`权限才能执行

### 系统目录结构

`Linux`一切皆文件：有文件就有读写权限

==Linux中，根目录为/，所有的文件都挂载在这个节点下==

登录系统后，在当前命令窗口下输入命令  `ls /`

![img](https://www.runoob.com/wp-content/uploads/2014/06/d0c50-linux2bfile2bsystem2bhierarchy.jpg)

以下是对这些文件夹的解释：

- `/bin`： `bin`是`Binary`的缩写，这个目录存放着最经常使用的命令。

- `/boot`：这里存放的是启动`Linux`时使用的一些核心文件，包括一些连接文件以及镜像文件。（不要动）

- `/dev`：`dev`是`Device`的缩写，存放的是`Linux`的外部设备，在`Linux`中访问设备的方式和访问文件的方式是相同的。

- ==`/etc`：这个目录用来存放所有的系统管理所需要点配置文件和子目录。==

- ==`/home`：用户的主目录，在`Linux`中，每个用户都有一个自己的目录，一般该目录是以用户的账号命名的。==

- `/lib`：这个目录里存放着系统最基本的同台连接共享库，其作用类似于`Windows`里面的`DLL`文件。（不要动）

- `/lost+found`: 这个目录一般情况下是空的，当系统非法关机后，这里就会存放一些文件。（存放突然关机的一些文件）

- `/media`：`linux`系统会自动识别一些设备，例如U盘，光驱等等，当识别后，`linux`会把识别的设备挂载到这个目录下。

- `/mnt`：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载`/mnt/`上，然后进入该目录就可以查看光驱里面的内容了。（我们后面会把一些本地文件挂载在这个目录下）

- ==`/opt`：这是给主机额外安装软件所摆放的目录。比如你安装一个`ORACLE`数据库，则可以放到这个目录下。默认是空的。==

- `/proc`：这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。

- ==`/root`：该目录为系统管理员，也称作超级权限者的用户目录。==

- `/run`：是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删除或清除。

- `/sbin`：`s`就是`super`的意思，这里存放的是系统管理员使用的系统管理程序。

- `/srv`：该目录存放一些服务，启动之后需要提取数据。

- `/sys`：这是`linux2.6`内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统`sysfs`。

- ==`/tmp`：这个目录是用来存放一些临时文件的。==

- ==`/usr`：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于`windows`下的`program files` 目录。==

  `/usr`不是`user`的缩写，其实是`unix software resource`的缩写，也就是`unix`操作系统软件资源所放置的目录，而不是用户的数据；所有系统默认的软件都会放置到`/usr`，系统安装完时，这个目录会占用最多的硬盘容量。

  - `/usr/bin`： 系统用户使用的应用程序

  - `/usr/sbin`：超级用户使用的比较高级的管理程序和系统守护程序。

  - `/usr/src`：内核源代码默认的放置目录。

- ==`/var`：这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。==

- ==`/www`：存放服务器网站相关资源，环境，项目的网站==


## 常用的基本命令

### 目录管理

```
cd 切换目录命令
绝对路径和相对路径
```

```
cd .. 返回上一级目录
```

```
./ 当前目录
```

```
ls 列出目录(最常被使用的) ls -a , ls -l, ls -al
-a参数：all，查看全部的文件，包括隐藏文件 
-l参数：列出所有的文件，包含文件的属性和权限，没有隐藏文件
所有的linux命令可以组合使用
白色代表是文件，蓝色代表是文件夹
```

```
pwd 显示当前用户所在的目录
```

```
mkdir 创建文件夹  
-p参数：创建多级目录 mkdir -p test1/test2/test3
```

```
rmdir 删除文件目录和文件（仅能删除空目录，若存在文件，先删除文件）
-p参数：删除多级目录 
```

```
cp 复制文件或者目录 
cp 原来的地方 新的地方
```

```
rm 移出文件或者目录
-f 忽略不存在的文件，不会出现警告，强制删除
-r 递归删除目录
-i 互动，删除询问是否删除
rm -rf/ 系统中所有的文件就被删除了
```

```
mv 移动文件或者目录，重命名文件
-f 强制
-u 只替换已经更新过的文件
```

```
clear 清屏
```

### 基本属性

linux系统是一种典型的多用户系统，不同的用户处于不同的地位，拥有不同的权限。

为了保护系统的安全性，linux系统对不同的用户访问同一个文件（包括目录文件）的权限做了不同的规定。

在linux中我们可以使用`ls -ll`或者`ls -l`命令来显示一个文件的属性以及文件所属的用户和组，如：

```
[root@hewei /]# ls -ll
总用量 64
lrwxrwxrwx.  1 root root     7 11月 23 17:19 bin -> usr/bin
dr-xr-xr-x.  5 root root  4096 11月 23 17:35 boot
drwxr-xr-x  19 root root  2960 12月 31 09:43 dev
drwxr-xr-x. 78 root root  4096 12月 31 09:43 etc
drwxr-xr-x.  3 root root  4096 12月 31 09:43 home
lrwxrwxrwx.  1 root root     7 11月 23 17:19 lib -> usr/lib
lrwxrwxrwx.  1 root root     9 11月 23 17:19 lib64 -> usr/lib64
drwx------.  2 root root 16384 11月 23 17:19 lost+found
drwxr-xr-x.  2 root root  4096 4月  11 2018 media
drwxr-xr-x.  2 root root  4096 4月  11 2018 mnt
drwxr-xr-x.  2 root root  4096 4月  11 2018 opt
dr-xr-xr-x  85 root root     0 12月 31 09:43 proc
dr-xr-x---.  6 root root  4096 12月 30 17:21 root
drwxr-xr-x  24 root root   680 12月 31 09:43 run
lrwxrwxrwx.  1 root root     8 11月 23 17:19 sbin -> usr/sbin
drwxr-xr-x.  2 root root  4096 4月  11 2018 srv
dr-xr-xr-x  13 root root     0 12月 31 09:58 sys
drwxrwxrwt.  8 root root  4096 12月 31 09:44 tmp
drwxr-xr-x. 13 root root  4096 11月 23 17:19 usr
drwxr-xr-x. 19 root root  4096 12月 30 17:21 var
drwxr-xr-x   6 root root  4096 12月 30 17:21 www
```

#### 第一个字符

在Linux中第一个字符代表这个文件是目录，文件或连接文件（连接文件会指向一个具体的文件）等等：

- ==当为【d】表示为目录==
- ==当为【-】表示是文件==
- ==若是【l】表示为链接文档（link file）==
- 若是【b】则表示为装置文件里面的可供存储的接口设备（可随机存取装置）
- 若是【c】则表示为装置文件里面的串行接口设备，例如键盘，鼠标（一次性读取装置）。

#### 接下来的字符

==以三个为一组==，且均为【rwx】的三个参数的组合。

其中，【r】代表可读（read），【w】代表可写（write），【x】代表可执行（execute）。

要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号【-】而已。

每个文件的属性由左边第一部分的10个字符来确定。

#### 属主和属组

对于文件来说，它都有一个特定的所有者，也就是对该文件具有所有权的用户。

同时，在Linux系统中，用户是按组分类的，一个用户属于一个或多个组。

文件所有者以外的用户又可以分为文件所有者的同组用户和其他用户。

因此，Linux系统按文件所有者，文件所有者同组用户和其他用户来规定来不同的文件访问权限。

在以上实例中，boot文件是一个目录文件，属主和属组都为root。

##### chgrp 修改文件属组

```
chgrp [-R] 属组名 文件名
-R：递归更改文件属组，就是在更改某个目录文件的属组时，如果加上-R的参数，那么该目录下的所有文件的属组都会更改。
```

##### chown 更改文件属主，也可以同时更改文件属组

``` 
chown [-R] 属组名 文件名
chown [-R] 属组名：属组名 文件名
```

##### chmod 修改文件9个属性（必须掌握）

```
chmod [-R] xyz 文件或目录
```

`linux`文件属性有两种设置方法，一种是数字（常用的是数字），一种是符号。

`linux`文件的基本权限有9个，分别是`owner/group/others`三种身份，这三种身份各有自己的`read/write/execute`权限。

#### 文件内容查看

Linux系统中使用以下命令来查看文件的内容：

- `cat`由第一行开始显示文件内容，用来读文章，或者读取配置文件
- `tac`从最后一个开始显示 
- `nl`显示的时候，顺道输出行号，看代码的时候，希望显示行号
- `more`一页一页的显示文件内容
- `less`与`more`类似，但是比`more`更好的是，它可以往前翻页
- `head`只看头几行
- `tail`只看尾巴几行

==你可以使用`man`【命令】 来查看各个命令的使用文档，如：`man cat`==

## 账号管理

Linux系统是一个多用户多任务的分时==操作系统，任何一个要使用系统资源的用户，==都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。

每个用户账号都拥有一个唯一的用户名和各自的口令。

用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。

实现用户账号的管理，要完成的工作主要有如下几个方面：

- 用户账号的添加、删除与修改。
- 用户口令的管理。
- 用户组的管理。

#### 用户账号的管理

用户账号的管理工作主要涉及到用户账号的添加，修改和删除

##### 添加用户

添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号，用户组，主目录和登录Shell等资源。

```
useradd 选项 用户名
```

参数说明：

- 选项 :

  + -c comment 指定一段注释性描述。

  - -d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
  - -g 用户组 指定用户所属的用户组。
  - -G 用户组，用户组 指定用户所属的附加组。
  - ==-m==　使用者目录如不存在则自动建立。
  - -s Shell文件 指定用户的登录Shell。
  - -u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。

- 用户名 :

  + 指定新账号的登录名。



##### 删除用户 userdel

如果一个用户的账号不再使用，可以从系统中删除。

删除用户账号就是要将`/etc/passwd`等系统文件中的该用户记录删除，必要时还删除用户的主目录。

删除一个已有的用户账号使用userdel命令，其格式如下：

```
userdel 选项 用户名
	-r，它的作用是把用户的主目录一起删除。
```

##### 修改账户

修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。

修改已有用户的信息使用`usermod`命令，其格式如下：

```
usermod 选项 用户名
	常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值
```

##### 切换用户 

+ 切换用户的命令为：`su username` 

+ 从普通用户切换到`root`用户，还可以使用命令：`sudo su`

+ 在终端输入`exit`或`logout`或使用快捷方式`ctrl+d`，可以退回到原来用户，其实`ctrl+d`也是执行的`exit`命令

+ 在切换用户时，如果想在切换用户之后使用新用户的工作环境，可以在`su`和`username`之间加`-`，例如：`su - root`

+ $表示普通用户

+ \#表示超级用户，也就是root用户

##### 用户的密码设置问题

我们一般通过`root`创建用户的时候！要配置密码！

`linux`上输入密码是不会显示的，你正常输入就可以了，并不是系统的问题！

用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。

指定和修改用户口令的`Shell`命令是`passwd`。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。

命令的格式为：

```
passwd 选项 用户名
```

可使用的选项：

- ==-l== 锁定口令，即禁用账号。（比如说张三辞职了！冻结这个账号，一旦冻结，这个人就登录不上系统了！）
- -u 口令解锁。
- -d 使账号无口令。
- -f 强迫用户下次登录时修改口令。

## 用户组管理

属主，属组

每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理（开发，测试，运维，root）。

不同Linux系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户的同时创建。

用户组的管理涉及用户组的添加，删除和修改。==组的增加，删除和修改实际上就是对/etc/group文件的更新==。

##### 创建一个用户组 

```
groupadd 选项 用户组
```

可以使用的选项有：

- -g GID 指定新用户组的组标识号（GID）。
- -o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。

##### 删除一个已有的用户组

```
groupdel 用户组
```

##### 修改用户组的属性使用

```
groupmod 选项 用户组
```

常用的选项有：

- -g GID 为用户组指定新的组标识号。
- -o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。
- -n新用户组 将用户组的名字改为新名字

##### 切换组

如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。

用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如：

```
$ newgrp root
```

这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。

## 磁盘管理

### 概述

Linux磁盘管理好坏直接关系到整个系统的性能问题。

Linux磁盘管理常用命令为 `df`、`du`。

- `df` ：列出文件系统的整体磁盘使用量
- `du`：检查磁盘空间使用量

### df

`df`命令参数功能：检查文件系统的磁盘空间占用情况。可以利用该命令来获取硬盘被占用了多少空间，目前还剩下多少空间等信息。

```
df [-ahikHTm] [目录或文件名]
```

选项与参数：

- `-a` ：列出所有的文件系统，包括系统特有的 `/proc` 等文件系统；
- `-k` ：以 `KBytes` 的容量显示各文件系统；
- `-m` ：以 `MBytes` 的容量显示各文件系统；
- `-h` ：以人们较易阅读的 `GBytes`, `MBytes`, `KBytes` 等格式自行显示；
- `-H` ：以 `M=1000K` 取代 `M=1024K` 的进位方式；
- `-T` ：显示文件系统类型, 连同该 `partition` 的 `filesystem` 名称 (例如 ext3) 也列出；
- `-i` ：不用硬盘容量，而以 `inode` 的数量来显示

### du

`du`命令也是查看使用空间的，但是与`df`命令不同的是`du`命令是对文件和目录磁盘使用的空间的查看，还是和`df`命令有一些区别的，这里介绍 `du`命令。

语法：

```
du [-ahskm] 文件或目录名称
```

选项与参数：

- `-a` ：列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已。
- `-h` ：以人们较易读的容量格式 (`G/M`) 显示；
- `-s` ：列出总量而已，而不列出每个各别的目录占用容量；
- `-S` ：不包括子目录下的总计，与 `-s` 有点差别。
- `-k` ：以 `KBytes` 列出容量显示；
- `-m` ：以 `MBytes` 列出容量显示；

通配符 `*` 来代表每个目录。

与 `df` 不一样的是，`du` 这个命令其实会直接到文件系统内去搜寻所有的文件数据。

### 磁盘挂载与卸除

根文件系统之外的其他文件要想能够被访问，都必须通过“关联”至根文件系统上的某个目录来实现，此关联操作即为“挂载”，此目录即为“挂载点”,解除此关联关系的过程称之为“卸载”

`Linux` 的磁盘挂载使用`mount`命令，卸载使用`umount`命令。

磁盘挂载语法：

```
mount [-t 文件系统] [-L Label名] [-o 额外选项] [-n] 装置文件名 挂载点
```

磁盘卸载命令 umount 语法：

```
umount [-fn] 装置文件名或挂载点
```

选项与参数：

- -f ：强制卸除！可用在类似网络文件系统 (NFS) 无法读取到的情况下；
- -n ：不升级 /etc/mtab 情况下卸除。

## 进程管理

Linux中一切皆文件

文件：

​	读写执行（创建，删除，编辑，查看，移动，复制）

​	权限（用户，用户组）

系统：

​	磁盘

​	进程

### 基本概念

1. 在Linux中，每一个程序都有自己的一个进程，每一个进程都有一个id号

2. 每一个进程呢，都会有一个父进程

3. 可以有两种存在方式：前台运行，后台运行

4. 一般的话服务都是后台运行的，基本的程序都是前台运行的

### 命令

`ps`  查看当前系统中正在执行的各种进程的信息

```
ps -xxx 
```

- -a 显示当前终端运行的所有的进程信息
- -u 以用户的信息显示进程
- -x 显示后台运行进程的参数

```
#ps -aux 查看所有的进程
ps -aux|grep mysql     #查看mysql的进程
ps -aux|grep redis     #查看redis的进程
ps -aux|grep java      #查看java进程
# ｜ 在Linux这个叫管道符   A|B
# grep 查找文件中符合条件的字符串
```

`ps -ef`可以查看到父进程的信息

```
ps -ef|grep mysql #看父进程我们一般可以通过目录树结构来查看！

```

`kill`杀掉进程，等价于window结束任务

```
kill -9 进程的id       #表示强制结束该进程
```



